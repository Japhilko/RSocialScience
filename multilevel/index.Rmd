---
title: "Multilevel"
author: "Jan-Philipp Kolb"
date: "12 Mai 2017"
output: md_document
---

```{r, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Wie sehen die Daten aus?

- Beispiel Mehrebenenstruktur der Daten

![](https://raw.githubusercontent.com/Japhilko/RSocialScience/master/multilevel/figure/Multileveldata.png)


## [Andres Gutierrez - Multilevel Modeling of Educational Data using R](https://www.r-bloggers.com/multilevel-modeling-of-educational-data-using-r-part-1/)

- Lineare Modelle erkennen den Cluster-Effekt aufgrund der Intraklassen Korrelation nicht

![ ](https://i0.wp.com/lh3.googleusercontent.com/-Fap5-jEG14g/V_2jQPgy8zI/AAAAAAAAAWk/cOwXtlj6TYk/Screen%252520Shot%2525202016-10-11%252520at%2525209.42.37%252520PM.png?w=450&ssl=1)

- [Original Blog](http://hagutierrezro.blogspot.de/2016/10/multilevel-modeling-of-educational-data.html)

## Beispiel Mehrebenenmodelle

Untersuchungsgegenstand

- Es sollen die Kenntnisse (Fähigkeiten) von Grundschülern in Mathematik gemessen werden. 
- Dazu werden in einem Schulbezirk zunächst Schulen ausgewählt und anschließend Klassen. 
- Innerhalb der Klassen soll schließlich jeweils eine Stichprobe gezogen und diese getestet werden.

- Geht man zunächst von einer zufälligen Auswahl von Klassen aus, dann ist die Level-1-Variation durch die Schüler und die Level-2-Variation durch die Klassen bestimmt.

## Fragen hierzu

- Wie wäre die Auswahl der Schulen zu berücksichtigen?

- Wie kann zusätzlich eine Unterscheidung nach privaten und staatlichen Schulen in die Modellierung eingebracht werden?

## Beispiel in Goldstein (2010), Kapitel 1.2

Evaluierung der Effektivität von Schulen

Mehrebenen-Modelle:

- Schüler
- Klassenverbände
- Schulamtsbezirke oder Bundesländer


Unterscheidung

- Modelle mit vielen Parametern, die wiederum modelliert werden können
- Regressionen mit Koeffizienten, die zwischen Gruppen variieren können

## Bibliotheken


```{r,eval=F}
install.packages("lme4")
install.packages("sjPlot")
```

```{r}
library(ggplot2)
library(gridExtra)
library(lme4)
library(sjPlot)
library(dplyr)
```

## Beispieldaten

```{r}
mlexdat <- read.csv("https://github.com/Japhilko/RSocialScience/raw/master/data/mlexdat.csv") 
```

```{r,echo=F}
library(knitr)
kable(head(mlexdat))
```



## Formalistisch

- Bei der Analyse von Daten mit diesen hierarchischen Strukturen, sollte man immer zunächst ein Null-Modell anpassen
- Somit kann man die Variation erfassen, die auf die Schulen zurückzuführen ist:

- Das passende Modell sieht folgendermaßen aus:

$$
y_{ij} = \alpha_{j} + \varepsilon_{ij}

\alpha_{j} = \alpha_0 + u_{j}
$$
Die Gesamtvariation wird in zwei Teile zerlegt: 

- Variation zwischen Schülern (innerhalb der Schulen) und
- zwischen den Schulen (zwischen den Schulen). 


